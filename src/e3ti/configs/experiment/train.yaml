# configs/experiments/train.yaml

# -------- lightning params --------
trainer:
  overfit_batches: 0
  min_epochs: 1 # prevents early stopping
  max_epochs: 200
  accelerator: gpu
  log_every_n_steps: 1
  deterministic: False
  strategy: ddp
  val_check_interval: 1.0
  check_val_every_n_epoch: 1
  accumulate_grad_batches: 1
  gradient_clip_val: 0.5

checkpointer:
  dirpath: ${paths.ckpt_dir}
  save_last: True
  save_top_k: 5
  monitor: val/loss
  filename: epoch_{epoch}-step_{step}-loss_{val/loss:.4f}
  auto_insert_metric_name: False
  mode: min

# -------- optimizer and scheduler --------
optim:
  optimizer:
    name: Adam
    lr: 3e-5
    weight_decay: 0.0
    betas: [0.9, 0.999]

  scheduler:
    name: CosineAnnealingLR
    T_max: experiment.train.trainer.max_epochs
    eta_min: 1.0e-6

# -------- wandb --------
wandb:
  name: ${project.name}
  project: MolCrystalFlow
  save_dir: ${paths.wandb_dir}

wandb_watch:
  log: 'all'
  log_freq: 500

warm_start: null
warm_start_cfg_override: True